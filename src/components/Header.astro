---
import CartButton from "./CartButton.svelte";
import MenuIcon from "../svgs/MenuIcon.astro";
import Logo from "../svgs/Logo.astro";
import UserIcon from "../svgs/UserIcon.astro";
import Logout from "./Logout.astro";
import UiLanguages from "./UiLanguages.astro";
import HeaderButtons from "./HeaderButtons.svelte";

const { t } = Astro.locals;

let user;
const accessToken = Astro.cookies.get("access-token");

if (accessToken) {
    user = JSON.parse(accessToken.value);
}
---

<header class="sticky top-0 z-100 w-full px-2 py-3 md:px-6 md:py-8">
    <div
        class="mx-auto flex max-w-[1440px] items-center justify-between rounded-xl border-1 border-[#f3f3f3] bg-[#fbfbfb80] px-2 py-3 backdrop-blur-xl md:px-4 md:py-6"
    >
        <div class="flex items-center gap-2 md:gap-4">
            <a href="/" class="flex-shrink-0"><Logo /></a>
            <div class="hidden sm:block">
                <HeaderButtons client:load />
            </div>
        </div>
        <nav>
            <ul class="flex items-center gap-1 md:gap-4">
                {
                    accessToken && (
                        <li class="flex items-center pr-2">
                            <CartButton client:load />
                        </li>
                    )
                }
                <li class="flex items-center gap-1 pr-2 text-sm md:text-base">
                    <UserIcon />
                    {
                        accessToken && (
                            <span class="hidden sm:inline">
                                {t("greeting")}, {user.person.firstName}
                            </span>
                        )
                    }
                    {
                        !accessToken && (
                            <a href="/login" class="flex items-center gap-1">
                                <span class="hidden sm:inline">{t("header.login")}</span>
                            </a>
                        )
                    }
                </li>
                <li class="hidden items-center pr-2 md:flex">
                    <UiLanguages />
                </li>
                <li class="flex items-center md:hidden">
                    <MenuIcon />
                </li>
                <li class="hidden items-center md:flex">
                    <MenuIcon />
                </li>
            </ul>
        </nav>
    </div>
</header>
